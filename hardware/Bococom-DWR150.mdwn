# Name

The router is unbranded, but may has the following model names, depending on the seller:

 * Portable Mini 150M 802.11n WiFi Wireless 3G Router, model C1291
 * TopLink RT-3GWT Wireless N Access Point 3G Travel Size Mobile Router
 * Bococom DWR-150

# Identification

This is a small router with a single antenna, with the front and back covered with a blue strip. Some may have a logo on its top. It opens by removing 4 screws under the router, and reveals a Ralink RT3050F chip. The board is identified as `XDX-RN502R V2.0`.

[[!img RT-3GWT_2.jpg size="300x"]]

More pictures: http://www.flickr.com/photos/elecnix/sets/72157629696033799

# Specifications

 * Wireless LAN: IEEE802.11 b / g / n, 2400-2483.5 MHz
 * LAN: IEEE802.3/802.3u
 * 1 RJ45 port LAN 10/100Base-TX
 * 1 USB port (type A female)
 * 1 indicateur de puissance
 * 1 indicateur de réseau WLAN
 * DC 12V @ 1A
 * Power < 6W
 * 88mm × 65mm × 23mm, 108 grams
 * Working temperature: -10 ° C à +60 ° C
 * Température de stockage: -20 ℃ à +70 ℃
 * Humidité: 5% ~ 95% non-condensing
 * CE Certified
 * RoHS certification
 * Chipset: Ralink 3050

# Detection of original firmware

    $ sudo nmap -P0 -O 192.168.0.1
    
    Starting Nmap 5.21 ( http://nmap.org ) at 2012-03-29 22:45 EDT
    Nmap scan report for 192.168.0.1
    Host is up (0.0016s latency).
    Not shown: 996 closed ports
    PORT     STATE SERVICE
    23/tcp   open  telnet
    53/tcp   open  domain
    80/tcp   open  http
    2869/tcp open  unknown
    MAC Address: 00:B0:C0:01:8B:34 (Unknown)
    Device type: media device|general purpose
    Running: Chumby embedded, Linux 2.6.X
    OS details: Chumby Internet radio, Linux 2.6.13 - 2.6.28
    Network Distance: 1 hop
    
    OS detection performed. Please report any incorrect results at http://nmap.org/submit/ .
    Nmap done: 1 IP address (1 host up) scanned in 2.90 seconds

So this appears to be running Linux, and mistaken to be a [[Chumby|http://en.wikipedia.org/wiki/Chumby]].

$ nmap -P0 -sV 192.168.0.1

    Starting Nmap 5.21 ( http://nmap.org ) at 2012-03-29 22:58 EDT
    Nmap scan report for 192.168.0.1
    Host is up (0.030s latency).
    Not shown: 996 closed ports
    PORT     STATE SERVICE    VERSION
    23/tcp   open  telnet     Linksys WRT54G telnetd (Tomato firmware)
    53/tcp   open  domain     dnsmasq 2.22
    80/tcp   open  tcpwrapped
    2869/tcp open  unknown
    1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at http://www.insecure.org/cgi-bin/servicefp-submit.cgi :
    SF-Port2869-TCP:V=5.21%I=7%D=3/29%Time=4F752165%P=i686-pc-linux-gnu%r(GetR
    SF:equest,9F,"HTTP/1\.0\x20200\x20OK\r\nCONTENT-TYPE:\x20text/xml\r\nCONTE
    SF:NT-LENGTH:\x200\r\nDATE:\x20Thu,\x2001\x20Jan\x201970\x2001:45:44\x20GM
    SF:T\r\nSERVER:\x20Linux/2\.6\.21\x20UPnP/1\.0\x20myigd/1\.0\r\nCONNECTION
    SF::\x20close\r\n\r\n");
    Service Info: Device: WAP

There's a telnet server, a DNS and web server, and something unknown on port 2869.

Let's telnet into it, using the default `admin` username and `admin` password.

    $ telnet 192.168.0.1
    Trying 192.168.0.1...
    Connected to 192.168.0.1.
    Escape character is '^]'.
    Router login: admin
    Password: 
    Welcome to  Bococom Router Series
      For detailed information, please check:
            www.bococom.com
    
    
    BusyBox v1.12.1 (2010-11-26 17:38:48 CST) built-in shell (msh)
    Enter 'help' for a list of built-in commands.
    
    # 

The C1291 or Top Link RT3-GWT is revealing its name! Bococom is a company in [[Shenzhen|http://en.wikipedia.org/wiki/Shenzhen]], China.

A search for Bococom leads to a thread on the DD-WRT forum about some people flashing a very similar router, but based on the Ralink 3052, which is the 300Mbit/s version, with two antennas instead of one.

http://www.dd-wrt.com/phpBB2/viewtopic.php?t=82160&postdays=0&postorder=asc&start=30

It links to the OpenWRT forum with essentially the same flashing procedure, which involves using a serial cable.

https://forum.openwrt.org/viewtopic.php?pid=158105#p158105

The firmware they flash the router with is for the Aceex NR22/Y, and the same company also makes the NR11/Y which is 150 Mbit/s 1T1R, most likely using the same Ralink 3050 as our Bococom. There are still ongoing discussions as of today, march 28 2012. In the DD-WRT database, only the Aceex NR22/Y is listed.

Back to Bococom, they list the DWR150

http://www.bococom.com/product.asp?ProdNum=134&zid=200909221828087028825

There is no software available for download for this router on the Brococom web site:

http://www.bococom.com/download.asp?type=DWR150

## Serial Console Boot

I used an old cellphone serial communication cable to connect to the TTL-level serial port on the PCB and connected with minicom using these settings:

 * 57600 8N1

The output:

    U-Boot 1.1.3 (Apr  7 2010 - 09:43:57)                                           
                                                                                    
    Board: Ralink APSoC DRAM:  32 MB                                                
    relocate_code Pointer at: 81fac000                                              
    ======= config usb otg =====                                                    
    flash_protect ON: from 0xBF000000 to 0xBF0205C3                                 
    protect on 0                                                                    
    protect on 1                                                                    
    protect on 2                                                                    
    protect on 3                                                                    
    protect on 4                                                                    
    protect on 5
    protect on 6                                                                    
    protect on 7                                                                    
    protect on 8                                                                    
    protect on 9                                                                    
    flash_protect ON: from 0xBF030000 to 0xBF03FFFF                                 
    protect on 10                                                                   
    *** Warning - bad CRC, using default environment                                
                                                                                    
    ============================================                                    
    Ralink UBoot Version: 3.2                                                       
    --------------------------------------------                                    
    ASIC 3052_MP2 (Port5<->None)                                                    
    DRAM COMPONENT: 256Mbits                                                        
    DRAM BUS: 16BIT                                                                 
    Total memory: 32 MBytes                                                         
    Date:Apr  7 2010  Time:09:43:57                                                 
    ============================================                                    
    icache: sets:128, ways:4, linesz:32 ,total:16384                                
    dcache: sets:128, ways:4, linesz:32 ,total:16384                                
                                                                                    
     ##### The CPU freq = 320 MHZ ####                                              
                                                                                    
    SDRAM bus set to 16 bit                                                         
     SDRAM size =32 Mbytes                                                          
                                                                                    
    Please choose the operation:                                                    
       1: Load system code to SDRAM via TFTP.                                       
       2: Load system code then write to Flash via TFTP.                            
       3: Boot system code via Flash (default).                                     
       4: Entr boot command line interface.                                         
       9: Load Boot Loader code then write to Flash via TFTP.                       
                                                                                    
    You choosed 3                                                                   
                                                                                    
     0                                                                              
                                                                                    
    3: System Boot system code via Flash.                                           
    ## Booting image at bf050000 ...                                                
       Image Name:   Linux Kernel Image                                             
       Created:      2011-05-25   7:38:47 UTC                                       
                                                                                    
     System Control Status = 0x00400000                                             
       Image Type:   MIPS Linux Kernel Image (lzma compressed)                      
       Data Size:    3502016 Bytes =  3.3 MB                                        
       Load Address: 80000000                                                       
       Entry Point:  802d2000                                                       
       Verifying Checksum ... OK                                                    
       Uncompressing Kernel Image ... OK                                            
    No initrd                                                                       
    ## Transferring control to Linux (at address 802d2000) ...                      
    ## Giving linux memsize in MB, 32                                               
                                                                                    
    Starting kernel ...                                                             
                                                                                    
                                                                                    
    LINUX started...                                                                
                                                                                    
     THIS IS ASIC                                                                   
                                                                                    
    3G Router Start!                                                                

Then the console goes silent and does not echo back what I type.

Turning off the router, then holding the '4' key, I get:


Please choose the operation:                                                    
       1: Load system code to SDRAM via TFTP.                                       
       2: Load system code then write to Flash via TFTP.                            
       3: Boot system code via Flash (default).                                     
       4: Entr boot command line interface.                                         
       9: Load Boot Loader code then write to Flash via TFTP.                       
                                                                                    
    You choosed 4                                                                   
                                                                                    
     0                                                                              
                                                                                    
     eth_register                                                                   
    Eth0 (10/100-M)                                                                 
     enetvar=ethaddr,Eth addr:00:AA:BB:CC:DD:10                                     
     00:AA:BB:CC:DD:10:                                                             
                                                                                    
     eth_current->name = Eth0 (10/100-M)                                            
                                                                                    
                                                                                    
    4: System Enter Boot Command Line Interface.                                    
                                                                                    
    U-Boot 1.1.3 (Apr  7 2010 - 09:43:57)                                           
                                                                                    
     main_loop !!                                                                   
                                                                                    
     In main_loop !!                                                                
                                                                                    
                                                                                    
                                                                                    
     CONFIG_BOOTDELAY                                                               
    ### main_loop entered: bootdelay=5                                              
                                                                                    
    ### main_loop: bootcmd="tftp"                                                   
    RT3052 #                                    
    RT3052 # help                                                                   
    ?       - alias for 'help'                                                      
    boot    - boot default, i.e., run 'bootcmd'                                     
    bootd   - boot default, i.e., run 'bootcmd'                                     
    bootm   - boot application image from memory                                    
    bootp   - boot image via network using BootP/TFTP protocol                      
    cp      - memory copy                                                           
    echo    - echo args to console                                                  
    erase   - erase FLASH memory                                                    
    go      - start application at address 'addr'                                   
    help    - print online help                                                     
    loadb   - load binary file over serial line (kermit mode)                       
    md      - memory display                                                        
    mdio   - Ralink PHY register R/W command !!                                     
    mm      - memory modify (auto-incrementing)                                     
    mw      - memory write (fill)                                                   
    nm      - memory modify (constant address)                                      
    printenv- print environment variables                                           
    protect - enable or disable FLASH write protection                              
    reset   - Perform RESET of the CPU                                              
    run     - run commands in an environment variable                               
    saveenv - save environment variables to persistent storage                      
    setenv  - set environment variables                                             
    spicmd  - read/write data from/to eeprom or vtss                                
    tftpboot- boot image via network using TFTP protocol                            
    loopback   - Ralink eth loopback test !!                                        
    version - print monitor version                                                 
    RT3052 # 
