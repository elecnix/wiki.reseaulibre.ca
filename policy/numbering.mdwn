[[!toc levels=2]]

# IP allocation strategy

This section documents the strategy and the addresses already allocated. Select a free IP or prefix from this page, then document it on the wiki page of your [[node|nodes]].

IP addresses are allocated on a first come first serve basis. We
strongly encourage the use of IPv6 to simplify routing and allocation on both the mesh and your network (but IPv4 is also supported, as long as it is in the range described below).

## IPv6 addresses

You can get an IPv6 address prefix space by one of the following means:

* if your ISP supports IPv6 (ex: TekSavvy, ElectronicBox, Vidéotron) and has already allocated a network prefix to, you can announce that prefix on the mesh. This avoids having to manage with two sets of IP allocations on your local network. If your ISP does not support IPv6, make sure to call them and let them know that this is an important requirement for you!
* you can also get an IPv6 prefix from a free tunnel provider, such as [[Tunnel Broker|http://tunnelbroker.net/]] (by Hurricane Electric). This makes it possible to connect to the IPv6 public Internet, as well as announce that network prefix on the mesh.
* or, if you do not want to depend on an external entity or with to remain more anonymous on the mesh, you can use a network prefix from the address space `fd64:2c08:9fa7::/48`, known as unique-local addresses (ULA, see below). This means that the prefix is non-public routable (similar to 192.168.x.x on IPv4), but ensures a relative uniqueness worldwide, in case we inter-connect the mesh with another private network. The auto-configuration script of the Réseau Libre [[documentation/firmware]] automatically allocate a /60 prefix from this network.

See [[documentation/ipv6]] for more information.

To use a block part of our IPv6 space, select a free IPv6 /64 block from the list, and document it in the wiki page of your node.

This table is automatically generated using the metadata information in the node pages.

<table>
<tr><th>#</th><th>hostname</th><th>IPv6</th><th>IP</th><th>MAC</th></tr>
[[!report pages="nodes/* and (field(IPv6 *) or field(IP *))" template="iptable6" sort="field(IPv6)"]]
</table>

### Note on ULA prefixes

ULA prefixes are "local prefixes" (think like `192.168.0.1`) but that
are unique across sites *and* can potentially be routed between
sites. See [[!rfc 4193]] for more information about this. The Freifunk
project [also uses ULA prefixes](http://wiki.freifunk.net/6mesh.freifunk.net),
`fdca:ffee:babe:dada::/64`.

We are using `fd64:2c08:9fa7::/48` as our prefix. This prefix is advertised
from the mesh, so you should be able to see some routes and your
machine should autoconfigure itself. If you want to use a static IP in that network, document it here
first.

> *Note: the mesh prefix was chosen on
> [SixXS.net](https://www.sixxs.net/tools/grh/ula/), using the MAC
> address of my router. It was also registered there under Anarcat's
> email address.*

## IPv4

The proper allocation for new IPs is in the `172.16.0.0/12` private B
class (from [[!rfc 1918]]). `172.16.0.X/24` is reserved for big
interconnects (like [[nodes/boulette]]), so if you have just a node in
your window, using `172.16.1.X/24` for now (like [[nodes/carton]]).

This is the same table as in IPv6, but ordered by IPv4 address, to more easily find a free block:

<table>
<tr><th>#</th><th>hostname</th><th>IP</th><th>IPv6</th><th>MAC</th></tr>
[[!report pages="nodes/* and (field(IP *) or field(IPv6 *))" template="iptable" sort="field(IPv6)"]]
</table>

## VPN

These IPs are used "internally" for the [[inter-relay-node VPN|/documentation/vpn/]]. The 172.16.242.0/24 block is currently reserved for this purpose.

It is not yet clear whether or not these IP should be redistributed by babel. It might be best to do so to allow masquerading.

<table>
<tr><th>#</th><th>hostname</th><th>VPN</th><th>VPNv6</th></tr>
[[!report pages="nodes/* and (field(VPN *) or field(VPNv6 *))" template="iptable" sort="field(VPN)"]]
</table>

## Other Networks in the World

Documented here is our own policies, but we're not alone with this problem. See this [[list on the Open Networks Interoperability Wiki|http://interop.wlan-si.net/wiki/IPAddressing/List]] for IP ranges used by other community networks around the world.
