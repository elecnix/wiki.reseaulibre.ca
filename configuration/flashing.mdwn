[[!toc levels=3]]

This page is designed to give you quick howtos to flash common
devices. It is not meant to be a complete directory of all esoteric
devices, others have done this better.

# Firmware downloads

## OpenWRT firmware

To choose the firmware, look into the
[table of hardware](http://wiki.openwrt.org/toh/start) on the OpenWRT
site, each device page will list which firmware you should use.

(!) Hint: most Linksys WRT54 devices use the brcm47xx firmware.

(!) Note: Si vous avez des problèmes inhabituel, essayez une autre version du bon firmware http://downloads.openwrt.org/backfire/

# Flashing methods

## Web interface

If your router is still functional, the easiest way is to flash the
device through the web interface. This works on most firmware, even
the proprietary ones shipped with the device.

During the upload, pay attention to the following:

* do not disconnect the network cable
* do not close your browser
* look at the LEDs pattern to see if they settle down
* keep a ping to the router running

## TFTP upload

(!) In general, use the [[!debpkg atftp]] package instead of plain
"netkit" tftp, as it is more reliable.

1. connect the router with a wire to your computer
2. configure an IP on your computer

        ifconfig eth0:flash 192.168.1.2

3. reboot the router with the reset button pressed until the leds flash like a christmas tree
4. send the new firmware through tftp:

        atftp --trace --option "timeout 1" --option "mode octet" --put --local-file openwrt-xxx-x.x-xxx.bin 192.168.1.1

 with netkit-tftp:
 
        $ tftp 192.168.1.1
        tftp> binary
        tftp> rexmt 1
        tftp> timeout
        tftp> trace
        tftp> put openwrt.bin

For other platforms (Mac, Windows, etc), see: <http://wiki.openwrt.org/doc/howto/generic.flashing.tftp>

# Password reset

In general, try to connect on the web interface at
<http://192.168.1.1> (a commonly used default IP), that may give you
an idea of the firmware that is running.

## OpenWRT firmwares

If you are lucky enough to have a [[OpenWRT]] device, you may be able
to reset the password using this simpler procedure:

1. Unplug the router's power cord.
2. Connect the router's LAN1 port directly to your PC.
3. Configure your PC with a static IP address

        ifconfig eth0:flash 192.168.1.2

4. Plug the power on and wait for the DMZ LED to light up.
5. While the DMZ LED is on immediately press any button (Reset and Secure Easy Setup will work) a few times .

If done right the DMZ LED will quickly flash 3 times every second.

You should be able to telnet to the router at 192.168.1.1 now (no
username and password)

### Simple tips to recover the router in failsafe mode

NOTE: The root file system in failsafe mode is the SquashFS partition
mounted in readonly mode. To switch to the normal writable root file
system run mount_root and make any changes. Run `mount_root` now.

Forgot/lost your password and you like to set a new one

    passwd

Forgot the routers IP address

    uci get network.lan.ipaddr

You accidentally run 'ipkg upgrade' or filled up the flash by
installing to big packages (clean the JFFS2 partition and start over)

    mtd -r erase rootfs_data

If you are done with failsafe mode power cycle the router and boot in normal mode.

### sysupgrade

Si vous avez déjà OpenWRT, mais que vous voulez le flasher avec une autre version, vous pouvez utiliser la commande `sysupgrade`:

    ssh 192.168.1.1
    sysupgrade http:// ... /openwrt-blah-squashfs.trx

Si votre routeur n'a pas accès à internet, vous pouvez installer un petit serveur web sur votre ordinateur:

    sudo apt-get install nginx
    sudo cp openwrt-blah-squashfs.trx /usr/share/nginx/www/
    sudo /etc/init.d/nginx start

Puis vous spécifiez l'addresse de votre serveur sur votre PC connecté par ethernet sur un port LAN:

   sysupgrade http://192.168.1.2/openwrt-blah-squashfs.trx

## Tomato firmware

Just hold the reset key down until the power led flashes, see <http://www.polarcloud.com/tomatofaq#why_doesnt_my_password_work>.

## DD-WRT firmware

Hold the reset button for 30 seconds, see <http://www.dd-wrt.com/wiki/index.php/Reset_And_Reboot>.

# Other guides

* [[ddwrt install instructions|http://www.dd-wrt.com/wiki/index.php/Installation]]
* [[ddwrt bad flash recovery instructions|http://www.dd-wrt.com/wiki/index.php/Recover_from_a_bad_flash]]
