[[!ymlfront data="""
MAC: DC:9F:DB:0A:59:82
IP: 172.16.3.25
IPv6: fd64:2c08:9fa7:be40::1
"""]]

# SETUP

[[!waypoint lat="45.521123" lon="-73.585782" embed hidden width="950px" height="400px" right desc="Sur le toît de l'intermarché"]]

Operator: colonialemt(à)gmail.com, [[users/wahben]] sur IRC

Bullet M2 + 15dBi

# NODE - r-pop.relais.reseaulibre.ca

 * Status: [[!taglink up]]
 * Hostname: benode.relais.reseaulibre.ca
 * Location: 45.521123,-73.585782
 * Software: OpenWRT 12.09 RC1
 * IP address: {{$IP}}
 * IPv6 address: {{$IPv6}}
 * Routage: 
 * Hardware: Ubnt Bullet M2
 * MAC address: {{$MAC}}
 * Channel: 1
 * 802.11: b, g, n
 * Autonomie estimée: ?

### Antenna
 * Azimuth: H: 360° / V: 6°
 * Frequency: 2400 - 2483MHz
 * Gain: 15 dBi
 * Polarization: Vertical
 * SWR : ≤ 1.5:1
 * Impedance: 50 Ohm
 * Power: 

### Services prévus
 * Minecraft
 * File sharing

### Installation

Antenne: <img src="http://i.imgur.com/JPdsLqZ.jpg" width=940" />

### Info de configuration

/etc/config/babeld

    package babeld

    config general
	    option local_server '33123'

    config interface wan
	    option wired 'false'
	    #option update_interval '16'

    config interface lan
	    #option ignore 'true'
	    option wired 'true'
	    option update_interval '16'	 

    #config filter
    #	option type 'redistribute'
    #	option ge '13'
    #	option ip '172.16.0.0/12'
    #	option action 'metric 128'

    #config filter
    #	option type 'redistribute'
    #	option local 'true'
    #	option ip '192.68.5.0/24'
    #	option action 'deny'

/etc/firewall.user

    # This file is interpreted as shell script.
    # Put your custom iptables rules here, they will
    # be executed with each firewall (re-)start.
    #insmod ipt_LOG.o
    #iptables -A input_rule -i eth0 -j LOG --log-prefix "IN eth0: "

/etc/config/firewall

    config defaults
	    option syn_flood	1
	    option input		ACCEPT
	    option output		ACCEPT
	    option forward		REJECT
    # Uncomment this line to disable ipv6 rules
    #	option disable_ipv6	1

    config zone
	    option name		lan
	    option network		'lan'
	    option input		ACCEPT
	    option output		ACCEPT
	    option forward		REJECT

    config zone
	    option name		wan
	    option network		'wan'
	    option input		ACCEPT
	    option output		ACCEPT
	    option forward		REJECT
	    option masq		1
	    option mtu_fix		1

    config forwarding
	    option src		lan
	    option dest		wan


    # We need to accept udp packets on port 68,
    # see https://dev.openwrt.org/ticket/4108
    config rule
	    option name		Allow-DHCP-Renew
	    option src		wan
	    option proto		udp
	    option dest_port	68
	    option target		ACCEPT
	    option family		ipv4

    # Allow IPv4 ping
    config rule
	    option name		Allow-Ping
	    option src		wan
	    option proto		icmp
	    option icmp_type	echo-request
	    option family		ipv4
	    option target		ACCEPT

    # Allow DHCPv6 replies
    # see https://dev.openwrt.org/ticket/10381
    config rule
	    option name		Allow-DHCPv6
	    option src		wan
	    option proto		udp
	    option src_ip		fe80::/10
	    option src_port		547
	    option dest_ip		fe80::/10
	    option dest_port	546
	    option family		ipv6
	    option target		ACCEPT

    # Allow essential incoming IPv6 ICMP traffic
    config rule
	    option name		Allow-ICMPv6-Input
	    option src		wan
	    option proto	icmp
	    list icmp_type		echo-request
	    list icmp_type		echo-reply
	    list icmp_type		destination-unreachable
	    list icmp_type		packet-too-big
	    list icmp_type		time-exceeded
	    list icmp_type		bad-header
	    list icmp_type		unknown-header-type
	    list icmp_type		router-solicitation
	    list icmp_type		neighbour-solicitation
	    list icmp_type		router-advertisement
	    list icmp_type		neighbour-advertisement
	    option limit		1000/sec
	    option family		ipv6
	    option target		ACCEPT

    # Allow essential forwarded IPv6 ICMP traffic
    config rule
	    option name		Allow-ICMPv6-Forward
	    option src		wan
	    option dest		*
	    option proto		icmp
	    list icmp_type		echo-request
	    list icmp_type		echo-reply
	    list icmp_type		destination-unreachable
	    list icmp_type		packet-too-big
	    list icmp_type		time-exceeded
	    list icmp_type		bad-header
	    list icmp_type		unknown-header-type
	    option limit		1000/sec
	    option family		ipv6
	    option target		ACCEPT

    # include a file with users custom iptables rules
    config include
	    option path /etc/firewall.user


    ### EXAMPLE CONFIG SECTIONS
    # do not allow a specific ip to access wan
    #config rule
    #	option src		lan
    #	option src_ip	192.168.45.2
    #	option dest		wan
    #	option proto	tcp
    #	option target	REJECT

    # block a specific mac on wan
    #config rule
    #	option dest		wan
    #	option src_mac	00:11:22:33:44:66
    #	option target	REJECT

    # block incoming ICMP traffic on a zone
    #config rule
    #	option src		lan
    #	option proto	ICMP
    #	option target	DROP

    # port redirect port coming in on wan to lan
    #config redirect
    #	option src			wan
    #	option src_dport	80
    #	option dest			lan
    #	option dest_ip		192.168.16.235
    #	option dest_port	80
    #	option proto		tcp

    # port redirect of remapped ssh port (22001) on wan
    #config redirect
    #	option src		wan
    #	option src_dport	22001
    #	option dest		lan
    #	option dest_port	22
    #	option proto		tcp

    # allow IPsec/ESP and ISAKMP passthrough
    #config rule
    #	option src		wan
    #	option dest		lan
    #	option protocol		esp
    #	option target		ACCEPT

    #config rule
    #	option src		wan
    #	option dest		lan
    #	option src_port		500
    #	option dest_port	500
    #	option proto		udp
    #	option target		ACCEPT

    ### FULL CONFIG SECTIONS
    #config rule
    #	option src		lan
    #	option src_ip	192.168.45.2
    #	option src_mac	00:11:22:33:44:55
    #	option src_port	80
    #	option dest		wan
    #	option dest_ip	194.25.2.129
    #	option dest_port	120
    #	option proto	tcp
    #	option target	REJECT

    #config redirect
    #	option src		lan
    #	option src_ip	192.168.45.2
    #	option src_mac	00:11:22:33:44:55
    #	option src_port		1024
    #	option src_dport	80
    #	option dest_ip	194.25.2.129
    #	option dest_port	120
    #	option proto	tcp

    config rule
	    option name             Allow-Babel
	    option src              wan
	    option dest_port        6696
	    option proto            udp
	    option target           ACCEPT

    config rule
	    option name             Allow-Babel
	    option src              lan
	    option dest_port        6696
	    option proto            udp
	    option target           ACCEPT

    config rule
	    option name             Allow-SSH-wan
	    option src              wan
	    option dest_port        22
	    option proto            tcp
	    option target           ACCEPT

/etc/config/network

    config interface 'loopback'
	    option ifname 'lo'
	    option proto 'static'
	    option ipaddr '127.0.0.1'
	    option netmask '255.0.0.0'

    config interface 'wan'
	    option ifname 'wlan0'
	    option proto 'static'
	    option netmask '255.255.255.255'

    config interface 'lan'
	    option ifname 'eth0'
	    option type 'bridge'
	    option proto 'static'
	    option netmask '255.255.255.0'
	    option ip6addr 'fd64:2c08:9fa7:be40::1/64'
	    option ipaddr '172.16.3.25'

/etc/config/radvd

    config interface
	    option interface 'lan'
	    option AdvSendAdvert '1'
	    option AdvManagedFlag '0'
	    option AdvOtherConfigFlag '0'
	    list client ''
	    option ignore '0'

    config prefix
	    option interface 'lan'
	    option AdvOnLink '1'
	    option AdvAutonomous '1'
	    option ignore '0'
	    option AdvRouterAddr '1'
	    option prefix 'fd64:2c08:9fa7:be40::1/64'

    config route
	    option interface 'lan'
	    list prefix ''
	    option ignore '0'

    config rdnss
	    option interface 'lan'
	    list addr ''
	    option ignore '1'

    config dnssl
	    option interface 'lan'
	    list suffix ''
	    option ignore '1'

/etc/config/system

    config system
	    option timezone 'UTC'
	    option hostname 'benode'

    config timeserver 'ntp'
	    list server '0.openwrt.pool.ntp.org'
	    list server '1.openwrt.pool.ntp.org'
	    list server '2.openwrt.pool.ntp.org'
	    list server '3.openwrt.pool.ntp.org'
	    option enable_server '0'

/etc/config/ucitrack

    config network
	    option init network
	    list affects dhcp
	    list affects radvd

    config wireless
	    list affects network

    config firewall
	    option init firewall
	    list affects luci-splash
	    list affects qos
	    list affects miniupnpd

    config olsr
	    option init olsrd

    config dhcp
	    option init dnsmasq

    config dropbear
	    option init dropbear

    config httpd
	    option init httpd

    config fstab
	    option init fstab

    config qos
	    option init qos

    config system
	    option init led
	    list affects luci_statistics

    config luci_splash
	    option init luci_splash

    config upnpd
	    option init miniupnpd

    config ntpclient
	    option init ntpclient

    config samba
	    option init samba

    config tinyproxy
	    option init tinyproxy


/etc/config/wireless

    config wifi-device 'radio0'
	    option type 'mac80211'
	    option macaddr 'dc:9f:db:0a:59:82'
	    option hwmode '11ng'
	    option htmode 'HT20'
	    list ht_capab 'SHORT-GI-40'
	    list ht_capab 'TX-STBC'
	    list ht_capab 'RX-STBC1'
	    list ht_capab 'DSSS_CCK-40'
	    option channel '1'

    config wifi-iface
	    option device 'radio0'
	    option encryption 'none'
	    option mode 'adhoc'
	    option bssid '02:CA:FF:EE:BA:BE'
	    option network 'wan'
	    option ssid 'benode.relais.reseaulibre.ca'


### Links
Links: [[zoidberg]] ~65dbm

[[!meta copyright="Copyright © 2012 Alexandre Guédon"]]

[[!meta license="""[[!toggle id="license" text="GFDL 1.2+"]][[!toggleable
id="license" text="Permission is granted to copy, distribute and/or modify this
document under the terms of the GNU Free Documentation License, Version 1.2 or
any later version published by the Free Software Foundation; with no Invariant
Sections, no Front-Cover Texts, and no Back-Cover Texts.  A copy of the license
is included in the section entitled [[GNU Free Documentation
License|meta/gfdl]]."]]"""]]
